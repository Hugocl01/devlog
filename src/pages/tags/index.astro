---
import { getCollection } from "astro:content";
import BlogLayout from "@/layouts/BlogLayout.astro";
import TagSearch from "@/components/tags/TagSearch";

const posts = await getCollection("posts");
const tagMap = new Map();
posts.forEach((post) => {
  if (!post.data.draft) {
    post.data.tags?.forEach((tag) => {
      tagMap.set(tag, (tagMap.get(tag) || 0) + 1);
    });
  }
});
const tags = [...tagMap.entries()].sort((a, b) => a[0].localeCompare(b[0]));
---

<BlogLayout>
  <div class="container mx-auto px-4">
    <header class="py-16 text-center md:py-20">
      <h1 class="text-4xl font-extrabold tracking-tight md:text-5xl lg:text-6xl">
        Todas las Etiquetas
      </h1>
      <p class="mt-4 max-w-2xl mx-auto text-lg text-muted-foreground">
        Navega por todas las etiquetas del blog y descubre contenido relacionado.
      </p>
    </header>

    <section class="max-w-3xl mx-auto pb-20">
      <TagSearch client:load tags={tags} />
    </section>
  </div>
</BlogLayout>
